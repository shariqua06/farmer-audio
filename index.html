<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Farmer Subsidy Application ‚Äì Voice Form</title>
<link href="https://fonts.googleapis.com/css2?family=Material+Icons&family=Inter:wght@400;700&display=swap" rel="stylesheet">
<style>
body{font-family:'Inter',Arial,sans-serif;background:linear-gradient(135deg,#f7e0ff 0%,#e0d4ff 100%);color:#1e2539;min-height:100vh;margin:0;display:flex;align-items:center;justify-content:center;}
.container{background:#fff;border-radius:20px;width:100%;max-width:520px;padding:28px 14px 38px 14px;box-shadow:0 8px 32px rgba(112,144,176,0.18);}
h2{text-align:center;color:#7c3aed;margin-bottom:.35em;letter-spacing:1.2px;}
.subtitle{text-align:center;color:#888da8;font-size:1rem;margin:0 0 16px 0;}
#progressBar{width:100%;height:7px;background:#f1f5f9;border-radius:8px;margin:12px 0 20px;overflow:hidden;}
#progressBar span{display:block;height:100%;background:linear-gradient(90deg,#a78bfa,#f472b6);width:0%;transition:width .4s;}
.field-label{font-weight:600;font-size:1.03em;margin-bottom:4px;display:flex;align-items:center;gap:7px;}
input{width:100%;border:2px solid #e3e7f4;background:#fafdff;font-size:1em;border-radius:11px;padding:12px 14px;margin-bottom:10px;transition:border .2s;}
input:focus{border-color:#7c3aed;outline:none;background:#f6fafd;box-shadow:0 2px 8px rgba(120,130,255,0.12);}
.field-row{display:flex;gap:7px;margin-bottom:8px;align-items:flex-start;position:relative;}
.icon{font-family:'Material Icons';font-weight:normal;font-style:normal;font-size:1.35em;color:#7c3aed;vertical-align:bottom;}
.voice-btn{background:#ebe6ff;color:#523ae8;border-radius:50%;padding:.5em;width:50px;height:50px;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:28px;margin-left:7px;transition:all .2s;}
.voice-btn.listening{box-shadow:0 0 12px #7c3aed;animation:glow 1s infinite alternate;}
@keyframes glow{0%{box-shadow:0 0 4px #7c3aed;}100%{box-shadow:0 0 16px #a78bfa;}}
.voice-btn:disabled{opacity:.5;cursor:not-allowed;}
.submit-btn{width:100%;padding:13px;color:#fff;background:#7c3aed;border-radius:12px;border:none;font-size:1.1em;font-weight:700;margin-top:18px;cursor:pointer;}
.submit-btn:disabled{opacity:.5;cursor:not-allowed;}
.numeric-keypad{display:flex;flex-wrap:wrap;gap:4px;margin-bottom:10px;}
.numeric-keypad button{flex:1 0 22%;padding:12px;font-size:1.1em;border-radius:6px;border:1px solid #ccc;background:#f0f0ff;cursor:pointer;}
.numeric-keypad button:active{background:#d0d0ff;}
#successTick{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-size:80px;color:#16a34a;z-index:9999;}
.popup-summary{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#f3ebff;padding:25px;border-radius:20px;box-shadow:0 8px 32px rgba(112,144,176,0.25);text-align:center;z-index:999;min-width:300px;}
.subsidy-buttons{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:10px;}
.subsidy-button{flex:1 1 48%;padding:14px;font-size:1em;border-radius:12px;background:#ebe6ff;border:none;color:#523ae8;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:5px;transition:all .2s;}
.subsidy-button.selected{background:#7c3aed;color:#fff;}
.subsidy-icon{font-size:28px;}
</style>
</head>
<body>
<div class="container">
<h2>Farmer Subsidy Application</h2>
<div class="subtitle">Voice + Numeric Input | Tamil + English</div>
<div id="progressBar"><span></span></div>
<form id="form" autocomplete="off">

<!-- Name -->
<div class="field-row">
  <div style="flex:1;">
    <label class="field-label"><span class="icon">person</span>Name</label>
    <input id="name" placeholder="Enter Name">
  </div>
  <button type="button" class="voice-btn" id="voiceName"><span class="icon">mic</span></button>
</div>

<!-- Location -->
<div class="field-row">
  <div style="flex:1;">
    <label class="field-label"><span class="icon">location_on</span>Farm Location</label>
    <input id="location" placeholder="Enter Location">
  </div>
  <button type="button" class="voice-btn" id="voiceLocation"><span class="icon">mic</span></button>
</div>

<!-- Subsidy Type Buttons -->
<div class="field-row">
  <div style="flex:1;">
    <label class="field-label"><span class="icon">agriculture</span>Subsidy Type</label>
    <div class="subsidy-buttons" id="subsidyButtons">
      <button type="button" class="subsidy-button" data-value="urimam"><span class="subsidy-icon">ü™¥</span>‡Æâ‡Æ∞‡Æø‡ÆÆ‡ÆÆ‡Øç<br>Urimam</button>
      <button type="button" class="subsidy-button" data-value="parivu"><span class="subsidy-icon">üíß</span>‡Æ™‡Æ∞‡Æø‡Æµ‡ØÅ<br>Parivu</button>
      <button type="button" class="subsidy-button" data-value="vidhai"><span class="subsidy-icon">üåæ</span>‡Æµ‡Æø‡Æ§‡Øà<br>Vidhai</button>
      <button type="button" class="subsidy-button" data-value="ubagaranam"><span class="subsidy-icon">‚öô</span>‡Æâ‡Æ™‡Æï‡Æ∞‡Æ£‡ÆÆ‡Øç<br>Ubagaranam</button>
    </div>
  </div>
</div>

<!-- Amount -->
<div class="field-row">
  <div style="flex:1;">
    <label class="field-label"><span class="icon">payments</span>Amount</label>
    <input id="amount" placeholder="Enter Amount" pattern="[0-9]*">
    <div class="numeric-keypad" id="amountKeypad"></div>
  </div>
  <button type="button" class="voice-btn" id="voiceAmount"><span class="icon">mic</span></button>
</div>

<!-- Aadhaar -->
<div class="field-row">
  <div style="flex:1;">
    <label class="field-label"><span class="icon">credit_card</span>Aadhaar Number</label>
    <input id="aadhaarNumber" placeholder="XXXX XXXX XXXX" readonly maxlength="14">
    <div class="numeric-keypad" id="aadhaarKeypad"></div>
  </div>
</div>

<button type="submit" class="submit-btn" disabled>Submit Form</button>
</form>

<div id="successTick">‚úî</div>
<div class="popup-summary" id="summaryPopup"></div>
</div>

<script>
// Tamil audio URLs
const tamilAudios = {
  name: 'https://raw.githubusercontent.com/shariqua06/farmer-audio/main/name.mp3',
  location: 'https://raw.githubusercontent.com/shariqua06/farmer-audio/main/farmlocation.mp3',
  amount: 'https://raw.githubusercontent.com/shariqua06/farmer-audio/main/amount.mp3',
  aadhaar: 'https://raw.githubusercontent.com/shariqua06/farmer-audio/main/aadhar.mp3',
  afterAadhaar: 'https://raw.githubusercontent.com/shariqua06/farmer-audio/main/after-aadhar.mp3',
  subsidy: {
    urimam:'https://raw.githubusercontent.com/shariqua06/farmer-audio/main/urimam.mp3',
    parivu:'https://raw.githubusercontent.com/shariqua06/farmer-audio/main/parivu.mp3',
    vidhai:'https://raw.githubusercontent.com/shariqua06/farmer-audio/main/vidhai.mp3',
    ubagaranam:'https://raw.githubusercontent.com/shariqua06/farmer-audio/main/ubagaranam.mp3'
  }
};

// English TTS
function generateEnglishAudio(text){
  return new Promise(resolve=>{
    const utter=new SpeechSynthesisUtterance(text);
    utter.lang='en-IN';
    utter.onend=resolve;
    speechSynthesis.speak(utter);
  });
}

// Numeric Keypads
function createKeypad(targetInput,keypadDiv,maxLength,spacing=false){
  keypadDiv.innerHTML='';
  for(let i=0;i<=9;i++){
    const btn=document.createElement('button');
    btn.type='button';btn.textContent=i;
    btn.onclick=()=>{
      if(targetInput.value.replace(/\s/g,'').length<maxLength){
        targetInput.value+=i;
        if(spacing) targetInput.value=targetInput.value.replace(/(\d{4})(?=\d)/g,'$1 ');
        updateSubmitState();
      }
      if(targetInput.id==='aadhaarNumber' && targetInput.value.replace(/\s/g,'').length===12){
        playAfterAadhaarAudio();
      }
    };
    keypadDiv.appendChild(btn);
  }
}
createKeypad(document.getElementById('aadhaarNumber'),document.getElementById('aadhaarKeypad'),12,true);
createKeypad(document.getElementById('amount'),document.getElementById('amountKeypad'),10,false);

// Play After Aadhaar Audio
function playAfterAadhaarAudio(){
  const tamilAudio=new Audio(tamilAudios.afterAadhaar);
  tamilAudio.play();
  tamilAudio.onended=()=>{
    generateEnglishAudio('Aadhaar number completed. You can now submit.');
    document.querySelector('.submit-btn').disabled=false;
  };
}

// Voice Flow
async function voiceFlow(field,promptText){
  const btn=document.getElementById('voice'+field.charAt(0).toUpperCase()+field.slice(1));
  btn.classList.add('listening');btn.disabled=true;

  // Tamil first
  const tamilAudio=new Audio(tamilAudios[field]);
  await new Promise(res=>{tamilAudio.onended=res;tamilAudio.play();});

  // English prompt
  await generateEnglishAudio(promptText);

  // Voice recognition
  if(!('webkitSpeechRecognition'in window||'SpeechRecognition'in window)){
    alert('Voice recognition not supported');btn.classList.remove('listening');btn.disabled=false;return;
  }
  const recognition=new(window.SpeechRecognition||window.webkitSpeechRecognition)();
  recognition.lang='en-IN';recognition.interimResults=false;recognition.maxAlternatives=1;
  let timer=setTimeout(()=>{recognition.stop();},3000);
  recognition.onresult=e=>{
    clearTimeout(timer);
    let text=e.results[0][0].transcript.trim();
    document.getElementById(field).value=text;
    updateSubmitState();
  };
  recognition.onend=()=>{btn.classList.remove('listening');btn.disabled=false;};
  recognition.start();
}

// Buttons
document.getElementById('voiceName').onclick=()=>voiceFlow('name','Please say your name.');
document.getElementById('voiceLocation').onclick=()=>voiceFlow('location','Please say your farm location.');
document.getElementById('voiceAmount').onclick=()=>voiceFlow('amount','Please say the amount.');

// Subsidy Buttons
const subsidyButtons=document.querySelectorAll('.subsidy-button');
let selectedSubsidy='';
subsidyButtons.forEach(btn=>{
  btn.onclick=async ()=>{
    subsidyButtons.forEach(b=>b.classList.remove('selected'));
    btn.classList.add('selected');
    selectedSubsidy=btn.dataset.value;
    const audio=new Audio(tamilAudios.subsidy[selectedSubsidy]);
    audio.play();
    await new Promise(res=>audio.onended=res);
    await generateEnglishAudio("You selected",{btn:audio.replace(/\n/,' ')});
    updateSubmitState();
  };
});

// Submit
const form=document.getElementById('form');
form.onsubmit=async e=>{
  e.preventDefault();
  if(!selectedSubsidy){
    alert('Please select subsidy type.'); return;
  }
  const fields=['name','location','amount','aadhaarNumber'];
  for(let f of fields){if(!document.getElementById(f).value){alert('Please fill all fields.');return;}}

  document.getElementById('successTick').style.display='block';
  await generateEnglishAudio('Form submitted successfully.');

  const summary=document.getElementById('summaryPopup');
  summary.innerHTML=`<h3>Submitted Details</h3>
  <p><b>Name:</b> ${document.getElementById('name').value}</p>
  <p><b>Location:</b> ${document.getElementById('location').value}</p>
  <p><b>Subsidy:</b> ${selectedSubsidy}</p>
  <p><b>Amount:</b> ${document.getElementById('amount').value}</p>
  <p><b>Aadhaar:</b> ${document.getElementById('aadhaarNumber').value}</p>`;
  summary.style.display='block';

  setTimeout(()=>{
    document.getElementById('successTick').style.display='none';
    summary.style.display='none';
  },4000);

  form.reset();
  selectedSubsidy='';
  subsidyButtons.forEach(b=>b.classList.remove('selected'));
  document.querySelector('.submit-btn').disabled=true;
  updateSubmitState();
};

// Progress Bar
function updateSubmitState(){
  const fields=['name','location','amount','aadhaarNumber'];
  let filled=fields.filter(f=>document.getElementById(f).value).length;
  if(selectedSubsidy) filled++;
  document.querySelector('#progressBar span').style.width=(filled/5*100)+'%';
}
document.querySelectorAll('#name,#location,#amount,#aadhaarNumber').forEach(inp=>{
  inp.addEventListener('input',updateSubmitState);
});
updateSubmitState();
</script>
</body>
</html>
