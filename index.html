<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Farmer Subsidy Application – AI Form Filler</title>
<link href="https://fonts.googleapis.com/css2?family=Material+Icons&family=Inter:wght@400;700&display=swap" rel="stylesheet">
<style>
body {
  font-family:'Inter',Arial,sans-serif;
  background: linear-gradient(135deg,#f7e0ff 0%,#e0d4ff 100%);
  color:#1e2539;
  min-height:100vh;
  margin:0;
  display:flex;
  align-items:center;
  justify-content:center;
}
.container {
  background:#fff;
  border-radius:20px;
  width:100%;
  max-width:520px;
  padding:28px 14px 38px 14px;
  box-shadow:0 8px 32px rgba(112,144,176,0.18);
}
h2 {
  text-align:center;
  color:#7a3fff;
  margin-bottom:.35em;
  letter-spacing:1.2px;
}
.subtitle {
  text-align:center;
  color:#888da8;
  font-size:1rem;
  margin:0 0 16px 0;
}
#progressBar {
  width:100%;
  height:7px;
  background:#f1f5f9;
  border-radius:8px;
  margin:12px 0 20px;
  overflow:hidden;
}
#progressBar span {
  display:block;
  height:100%;
  background:linear-gradient(90deg,#b97aff,#ff77d9);
  width:0%;
  transition:width .4s;
}
.field-label {
  font-weight:600;
  font-size:1.03em;
  margin-bottom:4px;
  display:flex;
  align-items:center;
  gap:7px;
}
input,select {
  width:100%;
  border:2px solid #e3e7f4;
  background:#fafdff;
  font-size:1em;
  border-radius:11px;
  padding:12px 14px;
  margin-bottom:10px;
  transition:border .2s;
}
input:focus,select:focus {
  border-color:#7a3fff;
  outline:none;
  background:#f6fafd;
  box-shadow:0 2px 8px rgba(120,130,255,0.12);
}
.field-row {
  display:flex;
  gap:7px;
  margin-bottom:8px;
  align-items:flex-start;
}
.icon {
  font-family:'Material Icons';
  font-weight:normal;
  font-style:normal;
  font-size:1.35em;
  color:#ff77d9;
  vertical-align:bottom;
}
.voice-btn {
  background:#ebe6ff;
  color:#523ae8;
  border-radius:50%;
  padding:.5em;
  width:50px;
  height:50px;
  border:none;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  font-size:28px;
  margin-left:7px;
  position:relative;
  transition:background .2s;
}
.voice-btn.recording {
  box-shadow: 0 0 12px #ff77d9;
}
.voice-btn:disabled {
  opacity:.5;
  cursor:not-allowed;
}
#video {
  width:100%;
  border-radius:14px;
  margin-top:10px;
  margin-bottom:6px;
  background:#eee;
  min-height:135px;
  object-fit:cover;
  border:2px solid #e0e7ff;
}
#aadhaarNumber[readonly] {
  font-weight:600;
  background:#f4f8ff;
}
.submit-btn {
  width:100%;
  padding:13px;
  color:#fff;
  background:#7a3fff;
  border-radius:12px;
  border:none;
  font-size:1.1em;
  font-weight:700;
  margin-top:18px;
  cursor:pointer;
}
.submit-btn:hover {
  background:#ff77d9;
}
.numeric-keypad {
  display:flex;
  flex-wrap:wrap;
  gap:4px;
  margin-bottom:10px;
}
.numeric-keypad button {
  flex:1 0 22%;
  padding:12px;
  font-size:1.1em;
  border-radius:6px;
  border:1px solid #ccc;
  background:#f0f0ff;
  cursor:pointer;
}
.numeric-keypad button:active {
  background:#d0d0ff;
}
#successTick {
  display:none;
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  font-size:80px;
  color:#16a34a;
  z-index:9999;
}
@media(max-width:520px){
  .container {max-width:97vw;padding:10px;border-radius:12px;}
  #video {min-height:80px;}
  .voice-btn {width:45px;height:45px;font-size:24px;}
}
</style>
<!-- PART 2: JS + HTML continuation -->
<div class="container">
<form id="form" autocomplete="off">

<!-- Name -->
<div class="field-row">
  <div style="flex:1;">
    <label class="field-label" for="name"><span class="icon">person</span>Name</label>
    <input id="name" placeholder="Enter Name">
  </div>
  <button type="button" class="voice-btn" id="voiceName"><span class="icon">mic</span></button>
</div>

<!-- Farm Location -->
<div class="field-row">
  <div style="flex:1;">
    <label class="field-label" for="location"><span class="icon">location_on</span>Farm Location</label>
    <input id="location" placeholder="Enter Location">
  </div>
  <button type="button" class="voice-btn" id="voiceLocation"><span class="icon">mic</span></button>
</div>

<!-- Subsidy Type -->
<div class="field-row">
  <div style="flex:1;">
    <label class="field-label" for="subsidyType"><span class="icon">agriculture</span>Subsidy Type</label>
    <div id="subsidyOptions">
      <button type="button" class="subsidy-btn" data-value="urimam">
        <span class="icon">local_florist</span> உரிமம் / Urimam
      </button>
      <button type="button" class="subsidy-btn" data-value="parivu">
        <span class="icon">eco</span> பரிவு / Parivu
      </button>
      <button type="button" class="subsidy-btn" data-value="vidhai">
        <span class="icon">grass</span> விதை / Vidhai
      </button>
      <button type="button" class="subsidy-btn" data-value="ubagaranam">
        <span class="icon">agriculture</span> உபகரணம் / Ubagaranam
      </button>
    </div>
    <input type="hidden" id="subsidyType" value="">
  </div>
  <button type="button" class="voice-btn" id="voiceSubsidy"><span class="icon">mic</span></button>
</div>

<!-- Amount -->
<div class="field-row">
  <div style="flex:1;">
    <label class="field-label" for="amount"><span class="icon">payments</span>Amount</label>
    <input id="amount" placeholder="Enter Amount" pattern="[0-9]*">
    <div class="numeric-keypad" id="numericKeypad"></div>
  </div>
  <button type="button" class="voice-btn" id="voiceAmount"><span class="icon">mic</span></button>
</div>

<!-- Aadhaar Input -->
<div class="field-row">
  <div style="flex:1;">
    <label class="field-label" for="aadhaarNumber"><span class="icon">credit_card</span>Aadhaar Card</label>
    <div class="numeric-keypad" id="aadhaarKeypad"></div>
    <input id="aadhaarNumber" placeholder="XXXX XXXX XXXX" readonly>
    <video id="video" autoplay muted playsinline></video>
  </div>
</div>

<button type="submit" class="submit-btn">Submit Form</button>
</form>
<div id="successTick">✔</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5.4.0/dist/tesseract.min.js"></script>
<script>
// ===== PROGRESS BAR =====
function setProgress(val){document.querySelector("#progressBar span").style.width=val+"%";}
["name","location","subsidyType","amount","aadhaarNumber"].forEach((id,i)=>{
  document.getElementById(id).addEventListener("focus",()=>setProgress((i+1)*20));
});

// ===== Numeric Keypads =====
const amountInput=document.getElementById("amount");
const keypad=document.getElementById("numericKeypad");
[1,2,3,4,5,6,7,8,9,0].forEach(n=>{
  const btn=document.createElement("button");
  btn.type="button";
  btn.textContent=n;
  btn.onclick=()=>{amountInput.value+=n;};
  keypad.appendChild(btn);
});

const aadhaarInput=document.getElementById("aadhaarNumber");
const aadhaarKeypad=document.getElementById("aadhaarKeypad");
[1,2,3,4,5,6,7,8,9,0].forEach(n=>{
  const btn=document.createElement("button");
  btn.type="button";
  btn.textContent=n;
  btn.onclick=()=>{
    if(aadhaarInput.value.replace(/\s/g,'').length<12){
      let val=aadhaarInput.value.replace(/\s/g,'')+n;
      aadhaarInput.value=val.replace(/(\d{4})(?=\d)/g, '$1 ');
      if(val.length===12){
        playAfterAadhaar();
      }
    }
  };
  aadhaarKeypad.appendChild(btn);
});

// ===== After Aadhaar Audio =====
const afterAadhaarAudio=new Audio("https://raw.githubusercontent.com/shariqua06/farmer-audio/main/after-aadhar.mp3");
function playAfterAadhaar(){
  afterAadhaarAudio.play();
  afterAadhaarAudio.onended=()=>{
    const utter=new SpeechSynthesisUtterance("Details have been fetched from the bank linked to this Aadhaar number");
    utter.lang="en-IN";
    speechSynthesis.speak(utter);
    // Enable submit only after audio finishes
    document.querySelector(".submit-btn").disabled=false;
  };
}

// Initially disable submit button until Aadhaar audio finished
document.querySelector(".submit-btn").disabled=true;

// ===== Subsidy Type Voice & Click =====
const subsidyMap={'urimam':'urimam','parivu':'parivu','vidhai':'vidhai','ubagaranam':'ubagaranam','உரிமம்':'urimam','பரிவு':'parivu','விதை':'vidhai','உபகரணம்':'ubagaranam'};
document.querySelectorAll('.subsidy-btn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const val=btn.dataset.value;
    document.getElementById('subsidyType').value=val;
    // Play Tamil audio then English TTS
    const tamilAudio=new Audio("https://raw.githubusercontent.com/shariqua06/farmer-audio/main/type.mp3");
    tamilAudio.play();
    tamilAudio.onended=()=>{
      const utter=new SpeechSynthesisUtterance("Subsidy type selected: "+val);
      utter.lang='en-IN';
      speechSynthesis.speak(utter);
    };
  });
});
</script>
